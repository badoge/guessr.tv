const viewersSVG='<svg class="viewers-svg" width="24px" height="24px" version="1.1" viewBox="0 0 20 20" x="0px" y="0px">\n<g>\n  <path\n    fill-rule="evenodd"\n    d="M5 7a5 5 0 116.192 4.857A2 2 0 0013 13h1a3 3 0 013 3v2h-2v-2a1 1 0 00-1-1h-1a3.99 3.99 0 01-3-1.354A3.99 3.99 0 017 15H6a1 1 0 00-1 1v2H3v-2a3 3 0 013-3h1a2 2 0 001.808-1.143A5.002 5.002 0 015 7zm5 3a3 3 0 110-6 3 3 0 010 6z"\n    clip-rule="evenodd"\n  ></path>\n</g>\n</svg>',spinner='<div class="spinner-border" role="status">\n<span class="visually-hidden">Loading...</span>\n</div>',CLIENT_ID="ed2ch5dsxogpczmisjnbfnm92n4zps";function addBadges(t,e){try{let n="";for(let t=0;t<customBadges.length;t++)customBadges[t].users.includes(e)&&customBadges[t].sites.includes("guessr.tv")&&(n+=`<img src="${customBadges[t].url}" class="chat-badge" title="${customBadges[t].name}"/>`);if("streamer"==t)return n+='<img src="https://static-cdn.jtvnw.net/badges/v1/5527c58c-fb7d-422d-b71b-f309dcb85cc1/3" class="chat-badge" title="Broadcaster"/>',n;for(const e in t)if("subscriber"==e&&t.subscriber&&channelBadges.subscriber.length>0){n+=`<img src="${channelBadges.subscriber.find((e=>e.id===t.subscriber)).url}" class="chat-badge" title="Subscriber"/>`}else if("bits"==e&&channelBadges.bits.length>0){n+=`<img src="${channelBadges.bits.find((e=>e.id===t.bits)).url}" class="chat-badge" title="Bits"/>`}else if(Object.keys(globalBadges).length>0){n+=`<img src="${globalBadges[e].find((n=>n.id===t[e])).image_url_4x}" class="chat-badge" title="${e}"/>`}return n}catch(t){return console.log(t),""}}async function getTwitchUserId(t){try{let e=await fetch(`https://helper.donk.workers.dev/twitch/users?login=${t}`),n=await e.json();return n?.data&&n?.data[0]?.id?n.data[0].id:null}catch(t){return console.log("getTwitchUserId error",t),null}}async function getChannelBadges(t){try{let e=await getTwitchUserId(t);if(!e)return{subscriber:[],bits:[]};let n=await fetch(`https://helper.donk.workers.dev/twitch/chat/badges?broadcaster_id=${e}`),r=await n.json();if(!r?.data||r?.data?.length<1)return{subscriber:[],bits:[]};let a={subscriber:[],bits:[]},s=[],i=[];r?.data[0]?.versions?.length>0&&("subscriber"==r.data[0].set_id&&(s=r.data[0].versions),"bits"==r.data[0].set_id&&(i=r.data[0].versions)),r?.data[1]?.versions?.length>0&&("subscriber"==r.data[1].set_id&&(s=r.data[1].versions),"bits"==r.data[1].set_id&&(i=r.data[1].versions));for(let t=0,e=s.length;t<e;t++)a.subscriber.push({id:s[t].id,url:s[t].image_url_4x});for(let t=0,e=i.length;t<e;t++)a.bits.push({id:i[t].id,url:i[t].image_url_4x});return a}catch(t){return console.log("getChannelBadges error",t),{subscriber:[],bits:[]}}}async function getGlobalBadges(){try{let t=await fetch("https://helper.donk.workers.dev/twitch/chat/badges/global"),e=await t.json();if(!e.data||0==e.data.length)return{};if(e.data.length>0){let t={};for(let n=0,r=e.data.length;n<r;n++)t[e.data[n].set_id]=e.data[n].versions;return t}}catch(t){return console.log("getGlobalBadges error",t),{}}}async function get7TVPFP(t){if(!t)return"/pics/donk.png";try{let e=await fetch(`https://7tv.io/v3/users/twitch/${t}`);if(200!==e.status)return"/pics/donk.png";let n=await e.json();return n?.user?.avatar_url?n.user.avatar_url:"/pics/donk.png"}catch(t){return console.log("getprofilepic 7tv error",t),"/pics/donk.png"}}async function getTwitchPFP(t,e){let n={headers:{"client-id":CLIENT_ID,Authorization:`Bearer ${e}`}};try{let e=await fetch(`https://api.twitch.tv/helix/users?login=${t}`,n);return(await e.json()).data[0].profile_image_url}catch(t){return console.log("getprofilepic twitch error",t),"/pics/donk.png"}}async function checkToken(t){let e={headers:{Authorization:`OAuth ${t}`}};try{let t=await fetch("https://id.twitch.tv/oauth2/validate",e);return!!t.ok&&!((await t.json()).expires_in<600)}catch(t){return console.log("checkToken error",t),!1}}function changeSiteLinkTarget(t){let e=document.getElementsByClassName("site-link");for(let n=0;n<e.length;n++)e[n].setAttribute("target",t)}function shuffleArray(t){for(let e=t.length-1;e>0;e--){const n=Math.floor(Math.random()*(e+1));[t[e],t[n]]=[t[n],t[e]]}return t}function createRandomGenerator(t){const e=9853205067;let n=t;return function(t=n){return n=(5486230734*t+6908969830)%e,n/e}}function stringTo32BitHash(t){let e=0;for(let n=0;n<t.length;n+=1)e+=t.charCodeAt(n)<<n%24;return e%4294967295}function shuffleArraySeed(t,e){let n=[],r=createRandomGenerator(stringTo32BitHash(e));for(;t.length>1;)n.push(t.splice(Math.floor(r()*t.length),1)[0]);return n.push(t[0]),n}function checkSimilarity(t,e){if(-1===t)return!1;const n=Array(e.length+1).fill(null).map((()=>Array(t.length+1).fill(null)));for(let e=0;e<=t.length;e++)n[0][e]=e;for(let t=0;t<=e.length;t++)n[t][0]=t;for(let r=1;r<=e.length;r++)for(let a=1;a<=t.length;a++){const s=t[a-1]===e[r-1]?0:1;n[r][a]=Math.min(n[r][a-1]+1,n[r-1][a]+1,n[r-1][a-1]+s)}return n[e.length][t.length]<=2}function cleanString(t){return t.normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^a-z0-9]/gi,"").toLowerCase()}function enableTooltips(){[...document.querySelectorAll('[data-bs-toggle="tooltip"]')].map((t=>new bootstrap.Tooltip(t,{trigger:"hover"})))}function isInt(t){if(isNaN(t))return!1;let e=parseFloat(t);return(0|e)===e}function hasDuplicates(t){return new Set(t).size!==t.length}function showToast(t,e,n){let r=Date.now(),a=`<div id="${r}" class="toast align-items-center text-bg-${e} border-0" role="alert" data-bs-autohide="false" aria-live="assertive" aria-atomic="true">\n        <div class="d-flex">\n        <div class="toast-body" style="font-size:1.2em">${t}</div>\n        <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast" aria-label="Close"></button>\n        </div>\n        </div>`;elements.toastContainer.innerHTML+=a;let s=[].slice.call(document.querySelectorAll(".toast")).map((function(t){return new bootstrap.Toast(t,{animation:!1})}));s[s.length-1].show(),setTimeout((function(){s[s.length-1].hide(),document.getElementById(r).remove()}),n)}async function sendUsername(t=""){let e={method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({site:`guessr.tv${t}`,channel:channelName,platform:"twitch"})};try{let t=await fetch("https://helper.guessr.tv/log/username",e);console.log("sendUsername response",t.status),usernameSent=!0}catch(t){console.log("sendUsername error",t)}}async function getCustomBadges(){try{let t=await fetch("https://badges.donk.workers.dev"),e=await t.json();return e&&0!=e.length?e:[]}catch(t){return console.log("getCustomBadges error",t),[]}}async function getChannelId(){try{let t=await fetch(`https://helper.guessr.tv/twitch/users?login=${channelName}`);return(await t.json())?.data[0]?.id||""}catch(t){return console.log("getChannelId error",t),""}}async function getStreamerColor(){try{let t=await fetch(`https://helper.guessr.tv/twitch/chat/color?user_id=${channelId}`);return(await t.json())?.data[0]?.color||"#FFFFFF"}catch(t){return console.log("getStreamerColor error",t),"#FFFFFF"}}function showConfetti(t){let e,n,r;switch(parseInt(t,10)){case 1:e=100,n=1,r=1e3;break;case 2:e=500,n=2,r=2e3;break;case 3:e=1e3,n=3,r=3e3;break;case 4:e=1e4,n=5,r=5e3;break;default:return}confetti.maxCount=e,confetti.speed=n,confetti.start(r)}function encodeHTML(t){return t.replace(/[\u00A0-\u9999<>&]/g,(function(t){return`&#${t.charCodeAt(0)};`}))}