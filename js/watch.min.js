const elements={toastContainer:document.getElementById("toastContainer"),twitchEmbed:document.getElementById("twitchEmbed")};let player,mainList=[],retryLimit=0;async function getMainList(){try{let t=await fetch("https://api.okayeg.com/guess",requestOptions),e=await t.json();mainList=e.guess.guess}catch(t){console.log(t)}}async function nextStream(){if(0==mainList.length)return void showToast("No more channels left on the list, refresh to get a new list","danger","3000");if(retryLimit>5)return void showToast("Too many retries, something might be wrong :(","danger","3000");let t=mainList.pop();try{let e=await fetch(`https://helper.pepega.workers.dev/twitch/streams?user_id=${t.userid}`,requestOptions);if(!(await e.json()).data[0])return showToast("Channel is offline, getting new channel","info",1500),retryLimit++,nextStream()}catch(t){return console.log(t),retryLimit++,nextStream()}retryLimit=0;let e={width:"100%",height:"100%",channel:t.username,layout:"video-with-chat",parent:["guessr.tv","127.0.0.1"]};player?player.setChannel(t.username):player=new Twitch.Player("twitchEmbed",e)}window.onload=async function(){await getMainList(),shuffleArray(mainList),nextStream()};