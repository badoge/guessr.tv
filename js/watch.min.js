const elements={toastContainer:document.getElementById("toastContainer"),twitchEmbed:document.getElementById("twitchEmbed"),nextStream:document.getElementById("nextStream")};let player,mainList=[],retryLimit=0;async function getMainList(){try{let e=await fetch("https://api.okayeg.com/guess",requestOptions),t=await e.json();mainList=t.guess.guess}catch(e){console.log(e)}}async function nextStream(){if(elements.nextStream.disabled=!0,setTimeout((()=>{elements.nextStream.disabled=!1}),2e3),0==mainList.length)return void showToast("No more channels left on the list, refresh to get a new list","danger","3000");if(retryLimit>5)return void showToast("Too many retries, something might be wrong :(","danger","3000");let e=mainList.pop();try{let t=await fetch(`https://helper.pepega.workers.dev/twitch/streams?user_id=${e.userid}`,requestOptions);if(!(await t.json()).data[0])return showToast("Channel is offline, getting new channel","info",1500),retryLimit++,nextStream()}catch(e){return console.log(e),retryLimit++,nextStream()}retryLimit=0;let t={width:"100%",height:"100%",channel:e.username,layout:"video-with-chat",parent:["guessr.tv","127.0.0.1"]};player?player.setChannel(e.username):player=new Twitch.Embed("twitchEmbed",t)}window.onload=async function(){await getMainList(),shuffleArray(mainList),nextStream()};