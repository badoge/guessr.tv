const viewersSVG='<svg class="viewers-svg" width="24px" height="24px" version="1.1" viewBox="0 0 20 20" x="0px" y="0px">\n<g>\n  <path\n    fill-rule="evenodd"\n    d="M5 7a5 5 0 116.192 4.857A2 2 0 0013 13h1a3 3 0 013 3v2h-2v-2a1 1 0 00-1-1h-1a3.99 3.99 0 01-3-1.354A3.99 3.99 0 017 15H6a1 1 0 00-1 1v2H3v-2a3 3 0 013-3h1a2 2 0 001.808-1.143A5.002 5.002 0 015 7zm5 3a3 3 0 110-6 3 3 0 010 6z"\n    clip-rule="evenodd"\n  ></path>\n</g>\n</svg>',spinner='<div class="spinner-border" role="status">\n<span class="visually-hidden">Loading...</span>\n</div>',CLIENT_ID="ed2ch5dsxogpczmisjnbfnm92n4zps";function addBadges(e,t){try{let r="";for(let e=0;e<customBadges.length;e++)customBadges[e].users.includes(t)&&customBadges[e].sites.includes("guessr.tv")&&(r+=`<img src="${customBadges[e].url}" class="chat-badge" title="${customBadges[e].name}"/>`);if("streamer"==e)return r+='<img src="https://static-cdn.jtvnw.net/badges/v1/5527c58c-fb7d-422d-b71b-f309dcb85cc1/3" class="chat-badge" title="Broadcaster"/>',r;for(const t in e)if("subscriber"==t&&e.subscriber&&channelBadges.subscriber.length>0){r+=`<img src="${channelBadges.subscriber.find((t=>t.id===e.subscriber)).url}" class="chat-badge" title="Subscriber"/>`}else if("bits"==t&&channelBadges.bits.length>0){r+=`<img src="${channelBadges.bits.find((t=>t.id===e.bits)).url}" class="chat-badge" title="Bits"/>`}else if(Object.keys(globalBadges).length>0){r+=`<img src="${globalBadges[t].find((r=>r.id===e[t])).image_url_4x}" class="chat-badge" title="${t}"/>`}return r}catch(e){return console.log(e),""}}async function getTwitchUserId(e){try{let t=await fetch(`https://helper.donk.workers.dev/twitch/users?login=${e}`),r=await t.json();return r?.data&&r?.data[0]?.id?r.data[0].id:null}catch(e){return console.log("getTwitchUserId error",e),null}}async function getChannelBadges(e){try{let t=await getTwitchUserId(e);if(!t)return{subscriber:[],bits:[]};let r=await fetch(`https://helper.donk.workers.dev/twitch/chat/badges?broadcaster_id=${t}`),n=await r.json();if(!n?.data||n?.data?.length<1)return{subscriber:[],bits:[]};let a={subscriber:[],bits:[]},s=[],i=[];n?.data[0]?.versions?.length>0&&("subscriber"==n.data[0].set_id&&(s=n.data[0].versions),"bits"==n.data[0].set_id&&(i=n.data[0].versions)),n?.data[1]?.versions?.length>0&&("subscriber"==n.data[1].set_id&&(s=n.data[1].versions),"bits"==n.data[1].set_id&&(i=n.data[1].versions));for(let e=0,t=s.length;e<t;e++)a.subscriber.push({id:s[e].id,url:s[e].image_url_4x});for(let e=0,t=i.length;e<t;e++)a.bits.push({id:i[e].id,url:i[e].image_url_4x});return a}catch(e){return console.log("getChannelBadges error",e),{subscriber:[],bits:[]}}}async function getGlobalBadges(){try{let e=await fetch("https://helper.donk.workers.dev/twitch/chat/badges/global"),t=await e.json();if(!t.data||0==t.data.length)return{};if(t.data.length>0){let e={};for(let r=0,n=t.data.length;r<n;r++)e[t.data[r].set_id]=t.data[r].versions;return e}}catch(e){return console.log("getGlobalBadges error",e),{}}}async function get7TVPFP(e){if(!e)return"/pics/donk.png";try{let t=await fetch(`https://7tv.io/v3/users/twitch/${e}`);if(200!==t.status)return"/pics/donk.png";let r=await t.json();return r?.user?.avatar_url?r.user.avatar_url:"/pics/donk.png"}catch(e){return console.log("getprofilepic 7tv error",e),"/pics/donk.png"}}async function getTwitchPFP(e,t){let r={headers:{"client-id":CLIENT_ID,Authorization:`Bearer ${t}`}};try{let t=await fetch(`https://api.twitch.tv/helix/users?login=${e}`,r);return(await t.json()).data[0].profile_image_url}catch(e){return console.log("getprofilepic twitch error",e),"/pics/donk.png"}}async function checkToken(e){let t={headers:{Authorization:`OAuth ${e}`}};try{let e=await fetch("https://id.twitch.tv/oauth2/validate",t);return!!e.ok&&!((await e.json()).expires_in<600)}catch(e){return console.log("checkToken error",e),!1}}function changeSiteLinkTarget(e){let t=document.getElementsByClassName("site-link");for(let r=0;r<t.length;r++)t[r].setAttribute("target",e)}function shuffleArray(e){for(let t=e.length-1;t>0;t--){const r=Math.floor(Math.random()*(t+1));[e[t],e[r]]=[e[r],e[t]]}return e}function createRandomGenerator(e){const t=9853205067;let r=e;return function(e=r){return r=(5486230734*e+6908969830)%t,r/t}}function stringTo32BitHash(e){let t=0;for(let r=0;r<e.length;r+=1)t+=e.charCodeAt(r)<<r%24;return t%4294967295}function shuffleArraySeed(e,t){let r=[],n=createRandomGenerator(stringTo32BitHash(t));for(;e.length>1;)r.push(e.splice(Math.floor(n()*e.length),1)[0]);return r.push(e[0]),r}function checkSimilarity(e,t){if(-1===e)return!1;const r=Array(t.length+1).fill(null).map((()=>Array(e.length+1).fill(null)));for(let t=0;t<=e.length;t++)r[0][t]=t;for(let e=0;e<=t.length;e++)r[e][0]=e;for(let n=1;n<=t.length;n++)for(let a=1;a<=e.length;a++){const s=e[a-1]===t[n-1]?0:1;r[n][a]=Math.min(r[n][a-1]+1,r[n-1][a]+1,r[n-1][a-1]+s)}return r[t.length][e.length]<=2}function cleanString(e){return e.normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^a-z0-9]/gi,"").toLowerCase()}function enableTooltips(){[...document.querySelectorAll('[data-bs-toggle="tooltip"]')].map((e=>new bootstrap.Tooltip(e,{trigger:"hover"})))}function isInt(e){if(isNaN(e))return!1;let t=parseFloat(e);return(0|t)===t}function hasDuplicates(e){return new Set(e).size!==e.length}function showToast(e,t,r){let n=Date.now(),a=`<div id="${n}" class="toast align-items-center text-bg-${t} border-0" role="alert" data-bs-autohide="false" aria-live="assertive" aria-atomic="true">\n        <div class="d-flex">\n        <div class="toast-body" style="font-size:1.2em">${e}</div>\n        <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast" aria-label="Close"></button>\n        </div>\n        </div>`;elements.toastContainer.innerHTML+=a;let s=[].slice.call(document.querySelectorAll(".toast")).map((function(e){return new bootstrap.Toast(e,{animation:!1})}));s[s.length-1].show(),setTimeout((function(){s[s.length-1].hide(),document.getElementById(n).remove()}),r)}async function sendUsername(e=""){let t=new Date(localStorage.getItem("logTime1"));if(!(new Date-t>864e5))return;localStorage.setItem("logTime1",(new Date).toISOString());let r={method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({site:`guessr.tv${e}`,channel:channelName,platform:"twitch"})};try{let e=await fetch("https://helper.guessr.tv/log/username",r);console.log("sendUsername response",e.status),usernameSent=!0}catch(e){console.log("sendUsername error",e)}}async function getCustomBadges(){try{let e=await fetch("https://badges.donk.workers.dev"),t=await e.json();return t&&0!=t.length?t:[]}catch(e){return console.log("getCustomBadges error",e),[]}}async function getChannelId(){try{let e=await fetch(`https://helper.guessr.tv/twitch/users?login=${channelName}`);return(await e.json())?.data[0]?.id||""}catch(e){return console.log("getChannelId error",e),""}}async function getStreamerColor(){try{let e=await fetch(`https://helper.guessr.tv/twitch/chat/color?user_id=${channelId}`);return(await e.json())?.data[0]?.color||"#FFFFFF"}catch(e){return console.log("getStreamerColor error",e),"#FFFFFF"}}function showConfetti(e){let t,r,n;switch(parseInt(e,10)){case 1:t=100,r=1,n=1e3;break;case 2:t=500,r=2,n=2e3;break;case 3:t=1e3,r=3,n=3e3;break;case 4:t=1e4,r=5,n=5e3;break;default:return}confetti.maxCount=t,confetti.speed=r,confetti.start(n)}function encodeHTML(e){return e.replace(/[\u00A0-\u9999<>&]/g,(function(e){return`&#${e.charCodeAt(0)};`}))}function getLanguage(e){return new Intl.DisplayNames(["en"],{type:"language"}).of(e)}function escapeString(e){return assertString(e),e.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\//g,"&#x2F;").replace(/\\/g,"&#x5C;").replace(/`/g,"&#96;")}function unescapeString(e){return assertString(e),e.replace(/&quot;/g,'"').replace(/&#x27;/g,"'").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&#x2F;/g,"/").replace(/&#x5C;/g,"\\").replace(/&#96;/g,"`").replace(/&amp;/g,"&")}function assertString(e){if(!("string"==typeof e||e instanceof String)){let t=_typeof(e);throw null===e?t="null":"object"===t&&(t=e.constructor.name),new TypeError("Expected a string but received a ".concat(t))}}